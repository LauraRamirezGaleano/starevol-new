
      PROGRAM SOLDAT

************************************************************************
* Computation of various solar abundance functions                     *
************************************************************************

      implicit double precision (a-h , o-z)

      parameter (nele = 83, niso = 286)
      parameter (nam = 240)
      parameter (nsp = 54)

      character*2 name,adum

      common /abund/ a(nele),solabz(nele),solaba(nam)
      common /atomic/ am(niso),z(nele),ni(nele),name(nele)
      common /isorat/ abiso(niso),relah1(niso),rela(niso)
      common /massfrac/ fracx(niso)
      common /readdat/ aa(nam),zz(nele)

c     open (unit = 10,file = 'solabz.dat')
      open (unit = 11,file = 'solaba.dat')
c     open (unit = 12,file = 'solar_abund')
      open (unit = 20,file = 'soldat.out')

      zsun = 0.017563d0

c     do i = 1,nele
c        read (10,1000) zz(i),solabz(i)
c     enddo

      do m = 1,nam
         read (11,1100,end = 100) aa(m),solaba(m)
      enddo
 100  namr = m-1

      toth = solaba(1)+solaba(2)
      suma = 0.d0
      do m = 5,namr
         suma = suma+solaba(m)
      enddo
      suma = suma/toth
      relaz = suma/zsun
      write (*,*) zsun,suma,relaz

c     read (12,1201)
c     do i = 1,nele
c        do j = 1,ni(i)
c           ij = ij+1
cc          read (12,1200) ij,name(i),am(ij),z(i),abiso(ij),rela(ij),
cc   &           relah1(ij),fracx(ij)
c           read (12,1200) idum,adum,dum,dum,dum,rela(ij),relah1(ij),
c    &           fracx(ij)
c        enddo
c     enddo

c     close (10)
      close (11)
c     close (12)
      close (20)

 1000 format (1x,i2,2x,1pe13.7)
 1100 format (1x,i3,2x,1pe13.7)
 1201 format (13(1x,/))
 1200 format (1x,i3,2x,a2,1x,i3,1x,i2,2x,0pf9.7,2x,1pe12.6,1x,1pe12.6,
     &     2x,1pe13.7)

 3000 format (/,6x,'data (fracxs(l),l = 1,48) /')
 3100 format (5x,'&',1x,5(1pe11.5,','))
 3200 format (5x,'&',1x,2(1pe11.5,','),1pe11.5,' /')
 3300 format (/,6x,'data xsol,ysol,zsol,h2h1,he3he4 /')
 3400 format (5x,'&',1x,3(1pe13.7,','))
 3500 format (5x,'&',1x,1pe13.7,',',1pe13.7,' /',/)

      end



      BLOCK DATA

      implicit double precision (a-h , o-z)

      character*2 name

      common /atomic/ am(286),z(83),ni(83),name(83)
      common /isorat/ abiso(286),relah1(286),rela(286)

      data (name(k),k = 1,83) /
     & 'H ','He','Li','Be','B ','C ','N ','O ','F ','Ne','Na','Mg','Al',
     & 'Si','P ','S ','Cl','Ar','K ','Ca','Sc','Ti','V ','Cr','Mn','Fe',
     & 'Co','Ni','Cu','Zn','Ga','Ge','As','Se','Br','Kr','Rb','Sr','Y ',
     & 'Zr','Nb','Mo','Ru','Rh','Pd','Ag','Cd','In','Sn','Sb','Te','I ',
     & 'Xe','Cs','Ba','La','Ce','Pr','Nd','Sm','Eu','Gd','Tb','Dy','Ho',
     & 'Er','Tm','Yb','Lu','Hf','Ta','W ','Re','Os','Ir','Pt','Au','Hg',
     & 'Tl','Pb','Bi','Th','U ' /

      data (ni(k),k = 1,83) /
     & 2,2,2,1,2,2,2,3,1,3,1,3,1,3,1,4,2,3,3,6,1,5,2,4,1,4,1,5,2,5,2,5,
     & 1,6,2,6,2,4,1,5,1,7,7,1,6,2,8,2,10,2,8,1,9,1,7,2,4,1,7,7,2,7,1,
     & 7,1,6,1,7,2,6,2,5,2,7,2,6,1,7,2,4,1,1,2 /

      data (z(k),k = 1,83) /
     & 1.d0,2.d0,3.d0,4.d0,5.d0,6.d0,7.d0,8.d0,9.d0,10.d0,11.d0,12.d0,
     & 13.d0,14.d0,15.d0,16.d0,17.d0,18.d0,19.d0,20.d0,21.d0,22.d0,
     & 23.d0,24.d0,25.d0,26.d0,27.d0,28.d0,29.d0,30.d0,31.d0,32.d0,
     & 33.d0,34.d0,35.d0,36.d0,37.d0,38.d0,39.d0,40.d0,41.d0,42.d0,
     & 44.d0,45.d0,46.d0,47.d0,48.d0,49.d0,50.d0,51.d0,52.d0,53.d0,
     & 54.d0,55.d0,56.d0,57.d0,58.d0,59.d0,60.d0,62.d0,63.d0,64.d0,
     & 65.d0,66.d0,67.d0,68.d0,69.d0,70.d0,71.d0,72.d0,73.d0,74.d0,
     & 75.d0,76.d0,77.d0,78.d0,79.d0,80.d0,81.d0,82.d0,83.d0,90.d0,
     & 92.d0 /

      data (am(l),l = 1,286) /
     & 1.d0,2.d0,3.d0,4.d0,6.d0,7.d0,9.d0,10.d0,11.d0,12.d0,13.d0,14.d0,
     & 15.d0,16.d0,17.d0,18.d0,19.d0,20.d0,21.d0,22.d0,23.d0,24.d0,
     & 25.d0,26.d0,27.d0,28.d0,29.d0,30.d0,31.d0,32.d0,33.d0,34.d0,
     & 36.d0,35.d0,37.d0,36.d0,38.d0,40.d0,39.d0,40.d0,41.d0,40.d0,
     & 42.d0,43.d0,44.d0,46.d0,48.d0,45.d0,46.d0,47.d0,48.d0,49.d0,
     & 50.d0,50.d0,51.d0,50.d0,52.d0,53.d0,54.d0,55.d0,54.d0,56.d0,
     & 57.d0,58.d0,59.d0,58.d0,60.d0,61.d0,62.d0,64.d0,63.d0,65.d0,
     & 64.d0,66.d0,67.d0,68.d0,70.d0,69.d0,71.d0,70.d0,72.d0,73.d0,
     & 74.d0,76.d0,75.d0,74.d0,76.d0,77.d0,78.d0,80.d0,82.d0,79.d0,
     & 81.d0,78.d0,80.d0,82.d0,83.d0,84.d0,86.d0,85.d0,87.d0,84.d0,
     & 86.d0,87.d0,88.d0,89.d0,90.d0,91.d0,92.d0,94.d0,96.d0,93.d0,
     & 92.d0,94.d0,95.d0,96.d0,97.d0,98.d0,100.d0,96.d0,98.d0,99.d0,
     & 100.d0,101.d0,102.d0,104.d0,103.d0,102.d0,104.d0,105.d0,106.d0,
     & 108.d0,110.d0,107.d0,109.d0,106.d0,108.d0,110.d0,111.d0,112.d0,
     & 113.d0,114.d0,116.d0,113.d0,115.d0,112.d0,114.d0,115.d0,116.d0,
     & 117.d0,118.d0,119.d0,120.d0,122.d0,124.d0,121.d0,123.d0,120.d0,
     & 122.d0,123.d0,124.d0,125.d0,126.d0,128.d0,130.d0,127.d0,124.d0,
     & 126.d0,128.d0,129.d0,130.d0,131.d0,132.d0,134.d0,136.d0,133.d0,
     & 130.d0,132.d0,134.d0,135.d0,136.d0,137.d0,138.d0,138.d0,139.d0,
     & 136.d0,138.d0,140.d0,142.d0,141.d0,142.d0,143.d0,144.d0,145.d0,
     & 146.d0,148.d0,150.d0,144.d0,147.d0,148.d0,149.d0,150.d0,152.d0,
     & 154.d0,151.d0,153.d0,152.d0,154.d0,155.d0,156.d0,157.d0,158.d0,
     & 160.d0,159.d0,156.d0,158.d0,160.d0,161.d0,162.d0,163.d0,164.d0,
     & 165.d0,162.d0,164.d0,166.d0,167.d0,168.d0,170.d0,169.d0,168.d0,
     & 170.d0,171.d0,172.d0,173.d0,174.d0,176.d0,175.d0,176.d0,174.d0,
     & 176.d0,177.d0,178.d0,179.d0,180.d0,180.d0,181.d0,180.d0,182.d0,
     & 183.d0,184.d0,186.d0,185.d0,187.d0,184.d0,186.d0,187.d0,188.d0,
     & 189.d0,190.d0,192.d0,191.d0,193.d0,190.d0,192.d0,194.d0,195.d0,
     & 196.d0,198.d0,197.d0,196.d0,198.d0,199.d0,200.d0,201.d0,202.d0,
     & 204.d0,203.d0,205.d0,204.d0,206.d0,207.d0,208.d0,209.d0,232.d0,
     & 235.d0,238.d0 /

c     data (aref(l),l = 1,286) /
c    & 0.279d11,0.949d6,0.386d6,0.272d10,4.28d0,52.8d0,0.730d0,4.22d0,
c    & 17.d0,0.999d7,0.111d6,0.312d7,0.115d5,0.237d8,0.904d4,0.476d5,
c    & 843.d0,0.320d7,0.777d4,0.234d6,0.574d5,0.848d6,0.107d6,0.118d6,
c    & 0.849d5,0.922d6,0.467d5,0.310d5,0.104d5,0.489d6,0.386d4,0.217d5,
c    & 103.d0,0.286d4,913.d0,0.850d5,0.160d5,26.d0,0.352d4,5.48d0,
c    & 254.d0,0.592d5,395.d0,82.5d0,0.127d4,2.4d0,114.d0,34.2d0,192.d0,
c    & 175.d0,0.177d4,132.d0,130.d0,0.732d0,292.d0,587.d0,0.113d5,
c    & 0.128d4,319.d0,0.955d4,0.522d5,0.825d6,0.198d5,0.252d4,0.225d4,
c    & 0.337d5,0.129d5,557.d0,0.177d4,449.d0,361.d0,161.d0,613.d0,
c    & 352.d0,51.7d0,236.d0,7.8d0,22.7d0,15.1d0,24.4d0,32.6d0,9.28d0,
c    & 43.4d0,9.28d0,6.56d0,0.55d0,5.6d0,4.7d0,14.7d0,30.9d0,5.7d0,
c    & 5.98d0,5.82d0,0.153d0,0.999d0,5.15d0,5.16d0,25.7d0,7.84d0,
c    & 5.12d0,2.11d0,0.132d0,2.32d0,1.51d0,19.4d0,4.64d0,5.87d0,1.28d0,
c    & 1.96d0,1.98d0,0.32d0,0.698d0,0.378d0,0.236d0,0.406d0,0.425d0,
c    & 0.244d0,0.615d0,0.246d0,0.103d0,0.35d-1,0.236d0,0.234d0,0.316d0,
c    & 0.588d0,0.348d0,0.344d0,0.142d-1,0.155d0,0.31d0,0.38d0,0.368d0,
c    & 0.163d0,0.252d0,0.234d0,0.201d-1,0.143d-1,0.201d0,0.206d0,
c    & 0.388d0,0.197d0,0.463d0,0.121d0,0.79d-2,0.176d0,0.372d-1,
c    & 0.252d-1,0.129d-1,0.555d0,0.293d0,0.925d0,0.328d0,1.25d0,0.177d0,
c    & 0.221d0,0.177d0,0.132d0,0.43d-2,0.124d0,0.428d-1,0.229d0,
c    & 0.342d0,0.909d0,1.53d0,1.63d0,0.9d0,0.571d-2,0.509d-2,0.103d0,
c    & 1.28d0,0.205d0,1.02d0,1.24d0,0.459d0,0.373d0,0.372d0,0.476d-2,
c    & 0.453d-2,0.109d0,0.296d0,0.353d0,0.504d0,3.22d0,0.4d-3,0.446d0,
c    & 0.216d-2,0.283d-2,1.d0,0.126d0,0.167d0,0.225d0,0.1d0,0.197d0,
c    & 0.687d-1,0.142d0,0.477d-1,0.467d-1,0.8d-2,0.399d-1,0.292d-1,
c    & 0.356d-1,0.191d-1,0.689d-1,0.586d-1,0.465d-1,0.508d-1,0.66d-3,
c    & 0.719d-2,0.488d-1,0.676d-1,0.516d-1,0.82d-1,0.721d-1,0.603d-1,
c    & 0.22d-3,0.37d-3,0.922d-2,0.745d-1,0.101d0,0.982d-1,0.111d0,
c    & 0.889d-1,0.35d-3,0.404d-2,0.843d-1,0.576d-1,0.672d-1,0.374d-1,
c    & 0.378d-1,0.32d-3,0.756d-2,0.354d-1,0.543d-1,0.4d-1,0.788d-1,
c    & 0.315d-1,0.357d-1,0.103d-2,0.24d-3,0.793d-2,0.287d-1,0.42d-1,
c    & 0.21d-1,0.541d-1,0.248d-5,0.207d-1,0.17d-3,0.35d-1,0.19d-1,
c    & 0.408d-1,0.38d-1,0.193d-1,0.351d-1,0.12d-3,0.107d-1,0.807d-2,
c    & 0.898d-1,0.109d0,0.178d0,0.277d0,0.247d0,0.414d0,0.17d-3,
c    & 0.105d-1,0.441d0,0.453d0,0.338d0,0.963d-1,0.187d0,0.52d-3,
c    & 0.339d-1,0.574d-1,0.785d-1,0.448d-1,0.101d0,0.233d-1,0.543d-1,
c    & 0.13d0,0.611d-1,0.593d0,0.644d0,1.83d0,0.144d0,0.42d-1,0.573d-2,
c    & 0.181d-1 /

      data (abiso(l),l = 1,286) /
     &  .9999660, .0000340, .0001419, .9998581, .0749825, .9250175,
     & 1.0000000, .1988690, .8011310, .9890110, .0109890, .9963276,
     &  .0036724, .9976158, .0003805, .0020037,1.0000000, .9297542,
     &  .0022576, .0679883,1.0000000, .7903075, .0997204, .1099720,
     & 1.0000000, .9222767, .0467140, .0310093,1.0000000, .9501363,
     &  .0075001, .0421635, .0002001, .7580175, .2419825, .8413676,
     &  .1583751, .0002574, .9313451, .0014499, .0672050, .9694762,
     &  .0064686, .0013510, .0207979, .0000393, .0018669,1.0000000,
     &  .0800333, .0729471, .7378074, .0550229, .0541892, .0025006,
     &  .9974994, .0435266, .8379060, .0949132, .0236542,1.0000000,
     &  .0580309, .9171558, .0220117, .0028015,1.0000000, .6825178,
     &  .2612605, .0112808, .0358474, .0090935, .6915709, .3084291,
     &  .4863150, .2792543, .0410155, .1872273, .0061880, .6005291,
     &  .3994709, .2051110, .2740417, .0780094, .3648285, .0780094,
     & 1.0000000, .0088496, .0901046, .0756235, .2365245, .4971842,
     &  .0917136, .5067797, .4932203, .0033998, .0221990, .1144394,
     &  .1146616, .5710857, .1742145, .7081604, .2918396, .0056502,
     &  .0993066, .0646349, .8304084,1.0000000, .5144610, .1121823,
     &  .1717791, .1735320, .0280456,1.0000000, .1482353, .0925490,
     &  .1592157, .1666667, .0956863, .2411765, .0964706, .0553763,
     &  .0188172, .1268817, .1258065, .1698925, .3161290, .1870968,
     & 1.0000000, .0102144, .1114947, .2229895, .2733420, .2647101,
     &  .1172493, .5185185, .4814815, .0124814, .0088798, .1248137,
     &  .1279185, .2409339, .1223299, .2875062, .0751366, .0429581,
     &  .9570419, .0097273, .0065894, .0033732, .1451246, .0766153,
     &  .2418743, .0857673, .3268572, .0462830, .0577884, .5728155,
     &  .4271845, .0008938, .0257737, .0088961, .0475983, .0710856,
     &  .1889381, .3180146, .3387999,1.0000000, .0012173, .0010851,
     &  .0219579, .2728746, .0437026, .2174469, .2643472, .0978511,
     &  .0795174,1.0000000, .0010598, .0010086, .0242692, .0659053,
     &  .0785966, .1122172, .7169432, .0008961, .9991039, .0019098,
     &  .0025022, .8841811, .1114068,1.0000000, .2720348, .1209044,
     &  .2381816, .0830613, .1716842, .0576714, .0564623, .0308523,
     &  .1538758, .1126109, .1372927, .0736599, .2657154, .2259931,
     &  .4779034, .5220966, .0020003, .0217912, .1479012, .2048795,
     &  .1563873, .2485225, .2185180,1.0000000, .0005577, .0009379,
     &  .0233708, .1888419, .2560138, .2489164, .2813617,1.0000000,
     &  .0013950, .0161027, .3360038, .2295827, .2678465, .1490693,
     & 1.0000000, .0012909, .0304986, .1428110, .2190576, .1613684,
     &  .3178958, .1270776, .9719575, .0280425, .0015587, .0515035,
     &  .1863999, .2727804, .1363902, .3513671, .0001198, .9998802,
     &  .0012785, .2632173, .1428894, .3068361, .2857787, .3547794,
     &  .6452206, .0001784, .0159063, .0119966, .1334939, .1620360,
     &  .2646093, .4117796, .3736762, .6263238, .0001270, .0078418,
     &  .3293576, .3383198, .2524328, .0719210,1.0000000, .0015320,
     &  .0998763, .1691120, .2312769, .1319899, .2975664, .0686465,
     &  .2946283, .7053717, .0195326, .1895719, .2058758, .5850197,
     & 1.0000000,1.0000000, .2404532, .7595468 /

      end
